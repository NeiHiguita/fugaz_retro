@model fugaz_retro.Models.Compra

@{
    ViewData["Title"] = "Detalles/Compra";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<div class="tbl">
    <h1>Detalles</h1>

    <div>

        <hr />
        <dl class="row">
            <dt class="col-sm-2">Fecha de Compra</dt>
            <dd class="col-sm-10">@Html.DisplayFor(model => model.FechaCompra)</dd>

            <dt class="col-sm-2">Método de Pago</dt>
            <dd class="col-sm-10">@Html.DisplayFor(model => model.MetodoPago)</dd>

            <dt class="col-sm-2">Subtotal</dt>
            <dd class="col-sm-10">@Html.DisplayFor(model => model.Subtotal)</dd>

            <dt class="col-sm-2">IVA</dt>
            <dd class="col-sm-10">@Html.DisplayFor(model => model.Iva)</dd>

            <dt class="col-sm-2">Descuento</dt>
            <dd class="col-sm-10">@Html.DisplayFor(model => model.Descuento)</dd>

            <dt class="col-sm-2">Precio Total</dt>
            <dd class="col-sm-10">@Html.DisplayFor(model => model.PrecioTotal)</dd>

            <dt class="col-sm-2">Proveedor</dt>
            <dd class="col-sm-10">@Html.DisplayFor(model => model.IdProveedorNavigation.TipoProveedor)</dd>

        </dl>
    </div>
    <div class="container">
        <h4>Detalles de Compra</h4>
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Insumo</th>
                    <th>Cantidad</th>
                    <th>Precio Unitario</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                <!-- Coloca la apertura de tbody aquí -->
                @foreach (var detalle in Model.DetalleCompras)
                {
                    <tr>
                        <td>
                            @if (detalle.IdInsumoNavigation != null)
                            {
                                @detalle.IdInsumoNavigation.NombreInsumo
                            }
                            else
                            {
                                <span>No se encontró el insumo relacionado</span>
                            }
                        </td>
                        <td>@detalle.Cantidad</td>
                        <td>@detalle.IdInsumoNavigation.PrecioUnitario</td> <!-- Acceder al precio unitario del insumo -->
                        <td>@(detalle.Cantidad * detalle.IdInsumoNavigation.PrecioUnitario)</td> <!-- Calcular el subtotal -->
                    </tr>
                }
            </tbody> <!-- Coloca el cierre de tbody aquí -->
        </table>
    </div>
    <div>
        <a asp-action="Index" class="btn btn-sm btn-secondary">Regresar</a>
    </div>
</div>

